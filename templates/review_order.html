{% extends "base.html" %}

{% block content %}
  <h1 class="text-center">Review Order</h1>

  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <form method="POST">
          <p class="text-center">Order ID: {{ order.id }}</p>
          <p class="text-center">User Name: {{ order.order.user.name }}</p>
          <p class="text-center">User Email: {{ order.order.user.email }}</p>
          <p class="text-center">Date Ordered: {{ order.date_ordered }}</p>

          <!-- Display the image -->
          {% if order.image_file %}
            <div class="form-group text-center">
              <label>Prescription Image:</label>
              <img src="{{ url_for('uploaded_file', filename=order.image_file) }}" alt="Prescription Image" style="width: 200px; height: auto; cursor: pointer;" onclick="showImage(this)">
            </div>
          {% endif %}
          <div class="form-group">
            <label for="drug_name">Drug Name:</label>
            <select id="drug_name" name="drug_name" class="form-control">
              {% for drug in drugs %}
                <option value="{{ drug.name }}" {% if drug.name == order.drug.name %} selected {% endif %}>{{ drug.name }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="form-group">
            <label for="quantity">Quantity:</label>
            <input id="quantity" name="quantity" type="number" value="{{ order.quantity }}" class="form-control">
          </div>
          <div class="form-group">
            <label for="quantity">Refill(s):</label>
            <input id="refills" name="refills" type="number" value="{{ order.refills }}" class="form-control">
          </div>

          <input type="hidden" name="order_id" value="{{ order.id }}">

          <div class="form-group">
            <label for="status">Status:</label>
            <select id="status" name="status" class="form-control">
              <option value="approved">Approve</option>
              <option value="denied">Deny</option>
            </select>
          </div>

          <div class="form-group text-center">
            <input type="submit" value="Submit" class="btn btn-primary">
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
  function showImage(img) {
      var src = img.src;
      var largeImage = document.createElement('img');
      largeImage.src = src;
      largeImage.style.display = 'block';
      largeImage.style.width = '500px'; // or the width you want
      largeImage.style.height = 'auto';

      var overlay = document.createElement('div');
      overlay.style.display = 'flex';
      overlay.style.justifyContent = 'center';
      overlay.style.alignItems = 'center';
      overlay.style.position = 'fixed';
      overlay.style.top = '0';
      overlay.style.bottom = '0';
      overlay.style.left = '0';
      overlay.style.right = '0';
      overlay.style.backgroundColor = 'rgba(0,0,0,0.7)';
      overlay.onclick = function() {
          document.body.removeChild(overlay);
      }

      overlay.appendChild(largeImage);
      document.body.appendChild(overlay);
  }
  </script>
{% endblock %}